æ³¨æ„ï¼Œæ–‡ä¸­é“¾æ¥å·²ç»è½¬ç§»è‡³[Github](https://github.com/PanDaoxi/very-control)ï¼ŒåŸé“¾æ¥å¤±æ•ˆã€‚

@[toc]

# å‰è¨€
**å‰æ’æé†’ï¼šè¿™ç¯‡æ–‡ç« æœ‰ç‚¹å„¿é•¿ï¼Œå¦‚æœç›´æ¥æƒ³çœ‹æ•ˆæœå¯ä»¥[æ¥æ­¤ä¸‹è½½](https://pandaoxi.coding.net/public/pandaoxi/Projects/git/files/master/Very_Control)ï¼Œä»£ç çœ‹çœ‹å°±è¡Œäº†ã€‚**
```
                                                                         _..._       .-'''-.                                    .-'''-.
                                                                      .-'_..._''.   '   _    \                                 '   _    \  .---.
 .----.     .----.   __.....__                                      .' .'      '.\/   /` '.   \    _..._                     /   /` '.   \ |   |
  \    \   /    /.-''         '.         .-.          .-           / .'          .   |     \  '  .'     '.                  .   |     \  ' |   |
   '   '. /'   //     .-''"'-.  `. .-,.--.\ \        / /          . '            |   '      |  '.   .-.   .     .|  .-,.--. |   '      |  '|   |
   |    |'    //     /________\   \|  .-. |\ \      / /           | |            \    \     / / |  '   '  |   .' |_ |  .-. |\    \     / / |   |
   |    ||    ||                  || |  | | \ \    / /            | |             `.   ` ..' /  |  |   |  | .'     || |  | | `.   ` ..' /  |   |
   '.   `'   .'\    .-------------'| |  | |  \ \  / /             . '                '-...-'`   |  |   |  |'--.  .-'| |  | |    '-...-'`   |   |
    \        /  \    '-.____...---.| |  '-    \ `  /               \ '.          .              |  |   |  |   |  |  | |  '-                |   |
     \      /    `.             .' | |         \  /                 '. `._____.-'/              |  |   |  |   |  |  | |                    |   |
      '----'       `''-...... -'   | |         / /                    `-.______ /               |  |   |  |   |  '.'| |                    '---'
                                   |_|     |`-' /                              `                |  |   |  |   |   / |_|
                                            '..'                                                '--'   '--'   `'-'

```
<center><font color="gray">VeryControl è½¯ä»¶çš„ Logo</font></center>
<br>

æˆ‘æœ€è¿‘å¤šå°‘æœ‰ç‚¹å„¿é—²å¾—æ…Œï¼Œå‰ä¸¤å¤©å‡ºå»ç©å„¿äº†ä¸€åœˆï¼Œè·¯ä¸Šå°±ä¸€ç›´ç›˜ç®—ç€è¿™äº‹å„¿ï¼Œå‰ä¸¤å¤©åšäº†ä¸ªé›å½¢ï¼Œä»Šå¤©å®Œå–„å¥½äº†ï¼Œåˆ†äº«ç»™å¤§å®¶ä¸€èµ·çœ‹ç€ç©å„¿ã€‚

è¿™ä¸ªç¨‹åºæ„Ÿè§‰è¿˜å‡‘åˆï¼Œåˆ¶ä½œäº†ä¸€ä¸ªç½‘é¡µç«¯ã€‚è™½ç„¶è®¾è®¡ä¸å’‹æ ·å§ï¼ˆæˆ‘æ˜¯åˆå­¦è€…ï¼‰ï¼Œä½†æ˜¯è‡³å°‘èƒ½åœ¨æ‰‹æœºã€ç”µè„‘ç­‰å„ç§è®¾å¤‡ä¸ŠæˆåŠŸè®¿é—®å¹¶è¿›è¡Œè¿œç¨‹å‘½ä»¤æ‰§è¡Œã€‚

ç”¨åˆ°çš„è¯­è¨€æ˜¯ $Python$  å’Œ $HTML$ï¼Œä½¿ç”¨äº† $Django$ æ¡†æ¶ï¼ŒåŠä¸€äº›å…¶ä»–çš„å°åŠŸèƒ½ã€‚
 
è½¯ä»¶æˆªå›¾ï¼š ![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://pic.2ge.org/cdn/?url=https://img-blog.csdnimg.cn/5341c25dea4f43968882cca2a9edd0d7.jpeg)
# è½¯ä»¶ä¸‹è½½
> å»ºè®®é˜…è¯»é‡Œé¢çš„æ³¨æ„äº‹é¡¹ï¼Œå¾ˆé‡è¦ã€‚

è½¯ä»¶ä¸‹è½½åœ°å€ï¼š<https://download.csdn.net/download/PanDaoxi2020/86265805>
è½¯ä»¶å®˜æ–¹ç½‘ç«™ï¼š<https://pandaoxi-project.github.io/very-control/>

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://pic.2ge.org/cdn/?url=https://img-blog.csdnimg.cn/e11873091ec445089515cef422062638.jpeg)

# ä»£ç å±•ç¤º
è®©æˆ‘ä»¬ä¸€èµ·æ¥çœ‹çœ‹è¿™ä¸ªå°é¡¹ç›®çš„æºä»£ç å­~

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://pic.2ge.org/cdn/?url=https://img-blog.csdnimg.cn/02d90a09ab394aab8a3b36b4312112ae.gif)
##  $HTML$ å‰ç«¯éƒ¨åˆ†
$HTML$ éƒ¨åˆ†ä¸»è¦æ˜¯å®¢æˆ·ç«¯çš„ä¸€äº›ä¸œè¥¿ï¼Œç›´æ¥åœ¨ç½‘é¡µä¸Šè®¿é—®ï¼Œå¹¶ä¼ å›ç›¸åº”çš„å†…å®¹ç»™åç«¯ $API$ ã€‚
### 1.å®¢æˆ·ç«¯ä¸»é¡µ
æœ€åŸºæœ¬çš„å†…å®¹ï¼Œå¯ä»¥ç›´æ¥åœ¨ä¸»é¡µå¡«å†™å‘½ä»¤çš„è¡¨å•ï¼Œç„¶å $POST$ ç»™åç«¯çš„ $API$ `/run`ã€‚

$$
\begin{cases}
  & \text command=æ™®é€šæ‰§è¡Œå‘½ä»¤ \\
  & \text echo=è¾“å…¥å‘½ä»¤ï¼Œå¹¶è¿”å›è¾“å‡ºå†…å®¹ \\
  & \text code=æ‰§è¡Œæ‰¹å¤„ç†å‘½ä»¤ \\
  & \text runf=è¿è¡Œåº”ç”¨ç¨‹åºï¼ˆéœ€è¦åº”ç”¨ç¨‹åºæäº¤å·¥å…·ï¼‰ \\
\end{cases}
$$

```html
<!--è®¾ç½®æ ‡é¢˜-->
<title>Very Control</title>
<!--CSSæ ·å¼-->
<style>
/*ç»™é¡µé¢æ·»åŠ èƒŒæ™¯å›¾ç‰‡ï¼Œè¿˜æ˜¯éšæœºçš„ï¼ˆè¿™æ˜¯ä¸€ä¸ªé£æ™¯å£çº¸APIï¼‰*/
.bg{
background-image: url(https://api.ixiaowai.cn/gqapi/gqapi.php);
}
/*è¿™æ˜¯ç»™è¾“å…¥æ¡†è®¾ç½®é€æ˜åº¦çš„ï¼Œè¿™æ ·è®¾ç½®æ­£å¥½èƒ½çœ‹æ¸…æ–‡å­—ä¹Ÿèƒ½æ¬£èµèƒŒæ™¯*/
input,textarea{
filter:alpha(Opacity=30);
-moz-opacity:0.4;
opacity:0.6;
}
</style>
<!--è®¾ç½®çš„divï¼Œæ˜¾ç¤ºèƒŒæ™¯å’Œæ–‡å­—-->
<div class="bg">
	<!--è¡¨å•-->
    <form id="run" action="/run" method="post" enctype="multipart/form-data">    
    <h1>Very Control å¤šå¯¹ä¸€è¿œç¨‹æ§åˆ¶å¹³å°</h1>    
    <p>è¾“å…¥å‘½ä»¤ï¼š <input type="text" name="command" placeholder="è¾“å…¥ Windows å‘½ä»¤ "/></p>
    <p>å¸¦æœ‰å›æ˜¾çš„å‘½ä»¤ï¼š<input type="text" name="echo" placeholder="è¾“å…¥å‘½ä»¤ï¼Œå¹¶è¿”å›è¾“å‡ºå†…å®¹ "/>
    <p>æäº¤æ‰¹å¤„ç†æ–‡ä»¶çš„æºä»£ç ï¼š</p>
    <p><textarea name="code" rows="10" cols="75" placeholder="è¾“å…¥ä½ çš„ Windows Batch ä»£ç "></textarea></p>
    <p>æˆ–è€…ä½¿ç”¨<b><a href="https://pandaoxi2020.lanzouy.com/iCMJm07i76ti" target="_blank">åº”ç”¨ç¨‹åºæäº¤å·¥å…·</a></b></p>
    <input type="submit" value="è¿è¡Œ"/>
    </form>
    <br><br>
    <p>å½“å‰è½¯ä»¶ä¿¡æ¯ï¼š</p>
    <p>ç‰ˆæœ¬ï¼š 1.3.0.0 [2022-7-22 Update]</p>
    <p>å¼€å‘è€…ï¼š<b><font face="Consolas"><a href="https://pandaoxi.github.io/" target="_blank">PanDaoxi</a></font></b></p>
    <p>å¼€æºåœ°å€ï¼š<a href="https://pandaoxi.coding.net/public/pandaoxi/Projects/git/files/master/Very_Control">ç‚¹å‡»è¿™é‡Œå»è®¿é—®</a>ï¼</p>
    <p>å¼€å‘è€…é‚®ç®±ï¼ˆæ¬¢è¿æ„è§åé¦ˆå’ŒæŠ€æœ¯æ”¯æŒï¼‰ï¼š<a target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=5paHiIKHiZ6P1NbU1KaXl8iFiYs" style="text-decoration:none;"><img src="http://rescdn.qqmail.com/zh_CN/htmledition/images/function/qm_open/ico_mailme_02.png"/></a></p>
</div>
<hr>
<!--å…¶ä»–åŠŸèƒ½çš„è¶…é“¾æ¥-->
<center><p>å…¶ä»–åŠŸèƒ½ï¼š<a href="ss">æˆªå–å±å¹•</a>		<a href="inf">æŸ¥çœ‹è¢«æ§åˆ¶è€…ä¿¡æ¯</a>		<a href="cam">æ•è·æ‘„åƒå¤´</a>		<a href="sendm">å‘é€æ¶ˆæ¯</a>		<a href="rn">é˜…è¯»å®˜æ–¹é€šçŸ¥</a></p></center>
```
### 2.æ‹ç…§ã€æˆªå›¾

> è¿™ä¸¤ä¸ªåŠŸèƒ½çš„é¡µé¢åŸºæœ¬ç›¸åŒã€‚

![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://pic.2ge.org/cdn/?url=https://img-blog.csdnimg.cn/3e75ad6375754a9bbec428718f0b4cbc.png)

```html

<title>æ‘„åƒå¤´æ•è·</title>
<center>
	<!--æ­¤å¤„æ­£å¸¸çš„è¯ï¼Œå¦‚æœæœ‰æ‘„åƒå¤´åº”è¯¥æ˜¾ç¤ºé»˜è®¤æ‘„åƒå¤´çš„ç”»é¢ã€‚ä¸ºäº†ä¿æŠ¤éšç§ï¼Œæˆ‘ç”¨å¼€å‘è€…æ¨¡å¼æ”¾äº†ä¸€å¼ å›¾ç‰‡æ›¿æ¢äº†æ‘„åƒå¤´å›¾åƒã€‚-->
    <img src="https://pandaoxis.coding.net/p/pdxres/d/pdxres/git/raw/master/RESOURCE/20220729_picture.png" alt="æ‘„åƒå¤´æ•è·" height="450" width="800"/>
    <br><br>
    <p>è¯¥åŠŸèƒ½å¯èƒ½ä¼šæ¯”è¾ƒå¡é¡¿ï¼›å¦‚æœä¸èƒ½æ­£å¸¸æ˜¾ç¤ºå‡ºæ‘„åƒå¤´å›¾åƒï¼Œå¯èƒ½æ˜¯å› ä¸ºè¢«æ§åˆ¶è®¾å¤‡çš„æ‘„åƒå¤´æ— æ³•è®¿é—®ã€‚</p>
    <br><hr>
    <a href="jump">å›åˆ°ä¸»é¡µ</a>		<a href="cam">é‡æ–°æ‹ç…§</a>
</center>
```

```html
<title>Screen Shot</title>
<center>
	<!--ä½¿ç”¨å›¾ç‰‡çš„base64æ˜¾ç¤ºï¼Œå› ä¸ºå¤ªé•¿æˆ‘å°±ä¸å†™äº†-->
    <img src="data:image/png;base64, ..." alt="æˆªå›¾" height="576" width="1024"/>
    <br><br><hr>
    <a href="jump">å›åˆ°ä¸»é¡µ</a>		<a href="ss">é‡æ–°æˆªå›¾</a>
</center>
```

## $Python$ åç«¯éƒ¨åˆ†
ç›®å½•æ ‘ï¼š

```python
D:.
â”‚  db.sqlite3
â”‚  main.py
â”‚  manage.py
â”‚
â””â”€VeryControl
        asgi.py
        settings.py
        urls.py
        wsgi.py
        __init__.py
```
æˆ‘ç‰¹æ„ç»™å®ƒåšäº†ä¸€ä¸ª[åº”ç”¨ç¨‹åºç‰ˆ](https://pandaoxi.coding.net/p/pandaoxi/d/Projects/git/raw/master/Very_Control/VeryControl_Server.exe)çš„ï¼Œå†…ç½® ç¬¬ $1.3.0.0$ çš„æœåŠ¡å™¨ç‰ˆæœ¬ å®ƒä¼šè‡ªå·±æ›´æ–°ï¼Œä¸ç”¨ç®¡å®ƒã€‚
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://pic.2ge.org/cdn/?url=https://img-blog.csdnimg.cn/8ea6ca2342cd496ea367d64659817a1e.png)

 ### 1. $/main.py$


>  è¿™ä¸ªç¨‹åºçš„ä¸»è¦åŠŸèƒ½æ˜¯ï¼š
>  - ç»˜åˆ¶ $LOGO$ ã€‚ğŸ˜‰
>  - ç”ŸæˆæœåŠ¡å™¨ï¼Œä½¿å¾—å‰ç«¯å¯ä»¥è®¿é—®ã€‚ğŸ˜Š
>  - æ£€æŸ¥æ˜¯å¦æœ‰æ›´æ–°ï¼Œå¦‚æœæ²¡æœ‰ç›´æ¥è¿è¡ŒæœåŠ¡å™¨ï¼›å¦‚æœæœ‰ï¼Œå°±å¼ºåˆ¶æ›´æ–°ã€‚ğŸ˜‘
> <br>
> ç¬¬ä¸‰æ¡æ€§è´¨æ„Ÿè§‰æœ‰é‚£ä¹ˆä¸€ç§ $Windows$ çš„ä¼ å¥‡è‰²å½©~ ğŸ˜‚

```python
# Copyright 2022 by PanDaoxi. All rights reserved.
from socket import socket, AF_INET, SOCK_DGRAM
from os import system, name
from time import strftime, sleep
from colorama import init, Fore, Back
from requests import get

version = "1.3.5.0"
updateFiles = {
    "./manage.py": "https://pandaoxi-project.github.io/very-control/Very_Control/manage.py",
    __file__: "https://pandaoxi-project.github.io/very-control/Very_Control/main.py",
    "./VeryControl/asgi.py": "https://pandaoxi-project.github.io/very-control/Very_Control/VeryControl/asgi.py",
    "./VeryControl/settings.py": "https://pandaoxi-project.github.io/very-control/Very_Control/VeryControl/settings.py",
    "./VeryControl/urls.py": "https://pandaoxi-project.github.io/very-control/Very_Control/VeryControl/urls.py",
    "./VeryControl/wsgi.py": "https://pandaoxi-project.github.io/very-control/Very_Control/VeryControl/wsgi.py",
}
headers = {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/103.0.5060.66 Safari/537.36 Edg/103.0.1264.44",
}

def update():
    for i in updateFiles.keys():
        with open(i, "wb") as f:
            f.write(get(updateFiles[i], headers=headers).content)
        sleep(0.3)

def getIP():
    try:
        sock = socket(AF_INET, SOCK_DGRAM)
        sock.connect(("8.8.8.8", 80))
        ip = sock.getsockname()[0]
    finally:
        sock.close()
    return ip

if __name__ == "__main__" and name == "nt":
    temp = get('https://pandaoxi-project.github.io/very-control/Very_Control/VeryControl/VERSION',headers=headers)
    temp.encoding = 'utf-8'
    latest = temp.text
    if latest != version:
        print('Please wait a moment, we are updating the software for you ...')
        update()
    system('cls')
    print(
        """                                                                         _..._       .-\'\'\'-.                                    .-\'\'\'-.          
                                                                      .-'_..._''.   '   _    \                                 '   _    \  .---. 
 .----.     .----.   __.....__                                      .' .'      '.\/   /` '.   \    _..._                     /   /` '.   \ |   | 
  \    \   /    /.-''         '.         .-.          .-           / .'          .   |     \  '  .'     '.                  .   |     \  ' |   | 
   '   '. /'   //     .-''"'-.  `. .-,.--.\ \        / /          . '            |   '      |  '.   .-.   .     .|  .-,.--. |   '      |  '|   | 
   |    |'    //     /________\   \|  .-. |\ \      / /           | |            \    \     / / |  '   '  |   .' |_ |  .-. |\    \     / / |   | 
   |    ||    ||                  || |  | | \ \    / /            | |             `.   ` ..' /  |  |   |  | .'     || |  | | `.   ` ..' /  |   | 
   '.   `'   .'\    .-------------'| |  | |  \ \  / /             . '                '-...-'`   |  |   |  |'--.  .-'| |  | |    '-...-'`   |   | 
    \        /  \    '-.____...---.| |  '-    \ `  /               \ '.          .              |  |   |  |   |  |  | |  '-                |   | 
     \      /    `.             .' | |         \  /                 '. `._____.-'/              |  |   |  |   |  |  | |                    |   | 
      '----'       `''-...... -'   | |         / /                    `-.______ /               |  |   |  |   |  '.'| |                    '---' 
                                   |_|     |`-' /                              `                |  |   |  |   |   / |_|                          
                                            '..'                                                '--'   '--'   `'-'                               \n\n"""
    )

    init(autoreset=True)
    print(
        "Welcome to Very_Control !\nControlled end:",
        Fore.RED + "http://%s:%s/\n" % (getIP(), strftime("%Y")),
    )
    system("python manage.py runserver %s:%s" % (getIP(), strftime("%Y")))
    input()
```
### 2. $/VeryControl/urls.py$ 
è¿™æ˜¯æœåŠ¡å™¨çš„æ ¸å¿ƒï¼Œæˆ‘ä»¬é å®ƒè¿›è¡Œä¸€ç³»åˆ—çš„æ§åˆ¶ã€‚

```python
from django.urls import path as site
from django.shortcuts import HttpResponse
from os import system, remove, environ
from base64 import a85decode, b64encode
from sys import path
from requests import get
from pyautogui import screenshot
from tkinter import Tk
from time import strftime, sleep
from cv2 import VideoCapture, imwrite
from pyttsx3 import init as ttsInit

# å®šä¹‰ TTS æœ—è¯»è€…
tts_name = []
engine = ttsInit()
voices = engine.getProperty('voices') 
for voice in voices:
    tts_name.append(voice.name) 
engine.stop()
del engine
tts_name.append('Windows <kbd>SAPI.spVoice</kbd>')

# æ±‚æœ€å¤§å…¬å› æ•°
def gcd(a, b):
    if b == 0:
        return a
    else:
        return gcd(b, a % b)


# é€‚é…å›¾ç‰‡æ¯”ä¾‹
def change(a, b):
    x = gcd(a, b)
    a /= x
    b /= x
    while a < 500 or b < 500:
        a *= 2
        b *= 2
    return (a, b)


# æ‹ç…§
def get_photo():
    cap = VideoCapture(0)
    f, frame = cap.read()
    imwrite("./photo.png", frame)
    with open("./photo.png", "rb") as f:
        temp = b64encode(f.read()).decode()
    remove("./photo.png")
    cap.release()
    return "data:image/png;base64,%s" % temp


# ä¸»é¡µ
def main(request):
    return HttpResponse(
        """<title>Very Control</title>
<style>
body{
background-image: url(https://pic1.zhimg.com/80/v2-fbbb97b977b5cebc66dc3cefab0ac981_1440w.jpg?source=1940ef5c);
}
input,textarea{
filter:alpha(Opacity=30);
-moz-opacity:0.4;
opacity:0.6;
}
</style>
    <form id="run" action="/run" method="post" enctype="multipart/form-data">    
    <h1>Very Control å¤šå¯¹ä¸€è¿œç¨‹æ§åˆ¶å¹³å°</h1>    
    <p>è¾“å…¥å‘½ä»¤ï¼š <input type="text" name="command" placeholder="è¾“å…¥ Windows å‘½ä»¤ "/></p>
    <p>å¸¦æœ‰å›æ˜¾çš„å‘½ä»¤ï¼š<input type="text" name="echo" placeholder="è¾“å…¥å‘½ä»¤ï¼Œå¹¶è¿”å›è¾“å‡ºå†…å®¹ "/>
    <p>ä¸Šä¼ åº”ç”¨ç¨‹åºï¼š<input type="file" name="runf"/></p>
    <p>æäº¤æ‰¹å¤„ç†æ–‡ä»¶çš„æºä»£ç ï¼š</p>
    <p><textarea name="code" rows="10" cols="75" placeholder="è¾“å…¥ä½ çš„ Windows Batch ä»£ç "></textarea></p>
    <input type="submit" value="è¿è¡Œ"/>
    </form>
    <br><br>
<hr>
<center><p>å…¶ä»–åŠŸèƒ½ï¼š<a href="ss">æˆªå–å±å¹•</a>\t\t<a href="inf">æŸ¥çœ‹è¢«æ§åˆ¶è€…ä¿¡æ¯</a>\t\t<a href="cam">æ•è·æ‘„åƒå¤´</a>\t\t<a href="sendm">å‘é€æ¶ˆæ¯</a>\t\t<a href="rn">é˜…è¯»å®˜æ–¹é€šçŸ¥</a></p></center>
"""
    )


# é˜…è¯»é€šçŸ¥
def readNotice(request):
    return HttpResponse(
        """<title>é˜…è¯»å®˜æ–¹é€šçŸ¥</title>
<h1>å®˜æ–¹é€šçŸ¥</h1>
<hr><br>
<iframe src="https://pandaoxi-project.github.io/very-control/" width="800" height="450"></iframe>
<p>é¡µé¢åŠ è½½è¾ƒæ…¢æ˜¯æ­£å¸¸ç°è±¡ï¼Œè¯·è€å¿ƒç­‰å€™ã€‚</p>
<br><hr>
<p>è½¯ä»¶ä¿¡æ¯ï¼š</p>
<p>å¼€å‘è€…ï¼š<b><font face="Consolas"><a href="https://pandaoxi.github.io/" target="_blank">PanDaoxi</a></font></b></p>
<p>å¼€å‘è€…é‚®ç®±ï¼ˆæ¬¢è¿æ„è§åé¦ˆå’ŒæŠ€æœ¯æ”¯æŒï¼‰ï¼š<a target="_blank" href="http://mail.qq.com/cgi-bin/qm_share?t=qm_mailme&email=5paHiIKHiZ6P1NbU1KaXl8iFiYs" style="text-decoration:none;"><img src="http://rescdn.qqmail.com/zh_CN/htmledition/images/function/qm_open/ico_mailme_02.png"/></a></p>
<p><a href="https://github.com/pandaoxi-project/very-control/tree/main/Very_Control"><kbd>Very_Control</kbd>è½¯ä»¶å·²ç»å¼€æºï¼Œæ¬¢è¿å‰æ¥æŸ¥çœ‹ğŸ˜€</a></p>
<center><a href="jump">å›åˆ°ä¸»é¡µ</a></center>
"""
    )


# è¿è¡Œ
def run(request):
    system("chcp 65001 >nul")
    text = request.POST.get("command")
    code = request.POST.get("code")
    runf = request.FILES.get("runf")
    echo = request.POST.get("echo")
    if code:  # ä¼˜å…ˆçº§æœ€é«˜çš„ æ‰§è¡Œæ‰¹å¤„ç†è„šæœ¬
        with open("temp.bat", "w", encoding="utf-8") as f:
            f.write(code + "\nexit")
        system("start %s\\temp.bat" % path[0])
    if runf:  # æ¬¡ä¹‹çš„åº”ç”¨ç¨‹åº
        with open("temp.exe", "wb") as f:
            f.write(b"")
        with open("temp.exe", "wb") as f:
            for i in runf.chunks():
                f.write(i)
        system("start %s\\temp.exe" % path[0])
    if text:  # æœ€åæ˜¯ç›´æ¥æ‰§è¡Œå‘½ä»¤
        system(text)
    if echo:  # å¸¦å›æ˜¾çš„æ‰§è¡Œå‘½ä»¤
        try:
            remove("temp.txt")
        except:
            pass
        system("%s >> temp.txt" % echo)
        with open("temp.txt", "r", encoding="utf-8") as f:
            ret = f.read().splitlines()
        s = ""
        for i in ret:
            s += "<p>%s</p>\n" % i
        return HttpResponse(
            """<title>ç¨‹åºè¿è¡Œç»“æœ</title>
%s
<br><hr><br>
<center><a href="jump">å›åˆ°ä¸»é¡µ</a></center>"""
            % s
        )
    return HttpResponse('<center><h1>è¿è¡ŒæˆåŠŸï¼ğŸ‰ğŸ‰</h1></center><meta http-equiv="refresh" content="2;url=jump"/>')


# æˆªå›¾
def ss(request):
    window = Tk()
    window.withdraw()
    width = window.winfo_screenwidth()
    height = window.winfo_screenheight()
    image = screenshot(region=(0, 0, width, height))
    image.save("./screenshot.png")
    with open("./screenshot.png", "rb") as f:
        content = b64encode(f.read()).decode()
    remove("./screenshot.png")
    w, h = change(width, height)
    return HttpResponse(
        """<title>Screen Shot</title>
<center>
    <img src="data:image/png;base64,%s" alt="æˆªå›¾" height="%d" width="%d">
    <br><br><hr>
    <a href="jump">å›åˆ°ä¸»é¡µ</a>\t\t<a href="ss">é‡æ–°æˆªå›¾</a>
</center>
    """
        % (content, h, w)
    )
    window.mainloop()


# ç¯å¢ƒä¿¡æ¯
def inf(request):
    system("chcp 65001 >nul")
    s1 = ""
    for i in environ.keys():
        s1 += "<p>%s\t%s</p>\n" % (i, environ[i])
    try:
        remove("temp.txt")
    except:
        pass
    system("tasklist>>temp.txt")
    with open("temp.txt", "r", encoding="utf-8") as f:
        s2 = f.read().splitlines()
    remove("temp.txt")
    s3 = ""
    for i in s2:
        s3 += "<p>%s</p>\n" % i
    return HttpResponse(
        """<title>Os_Environ</title>
<h1>ç³»ç»Ÿç¯å¢ƒå˜é‡ </h1>
%s
<br><br><hr>
<h1>è¿è¡Œçš„è¿›ç¨‹ï¼ˆå¦‚éœ€å¯¹é½å¯ä»¥çœ‹æ­¤ç½‘é¡µçš„æºä»£ç ï¼‰ </h1>
%s
<br><br><hr>
<center><a href="jump">è¿”å›ä¸»é¡µ</a></center>
"""
        % (s1, s3)
    )


# æ‹ç…§
def camera(request):
    return HttpResponse(
        """<title>æ‘„åƒå¤´æ•è·</title>
<center>
    <img src="%s" alt="æ‘„åƒå¤´æ•è·" height="450" width="800">
    <br><br>
    <p>è¯¥åŠŸèƒ½å¯èƒ½ä¼šæ¯”è¾ƒå¡é¡¿ï¼›å¦‚æœä¸èƒ½æ­£å¸¸æ˜¾ç¤ºå‡ºæ‘„åƒå¤´å›¾åƒï¼Œå¯èƒ½æ˜¯å› ä¸ºè¢«æ§åˆ¶è®¾å¤‡çš„æ‘„åƒå¤´æ— æ³•è®¿é—®ã€‚</p>
    <br><hr>
    <a href="jump">å›åˆ°ä¸»é¡µ</a>\t\t<a href="cam">é‡æ–°æ‹ç…§</a>
</center>
    """
        % get_photo()
    )


# å‘é€æ¶ˆæ¯æ–‡æœ¬
def sendMessage(request):
    return HttpResponse(
        """<title>å‘é€æ¶ˆæ¯æ–‡æœ¬</title>
<style>
body{
background-image: url(https://pic1.zhimg.com/80/f56513788384645db768d0ec542dec33_1440w.jpg);
}
input,textarea{
filter:alpha(Opacity=30);
-moz-opacity:0.4;
opacity:0.6;
}
</style>
    <form id="show" action="/showm" method="post" enctype="multipart/form-data">    
    <h1>Very Control - æ¶ˆæ¯å‘é€å™¨</h1>    
    <p>å‘é€è¯­éŸ³æ¶ˆæ¯ï¼ˆå†…å®¹å°†ä¼šåœ¨è¢«æ§åˆ¶ç«¯æœ—è¯»ï¼Œæ‚¨å¯ä»¥<b><a href="/settts">è‡ªå®šä¹‰æœ—è¯»è€…</a></b>ï¼Œæˆ–ä½¿ç”¨é»˜è®¤å€¼ï¼‰ï¼š<input type="text" name="reader" placeholder="è¾“å…¥è¦å‘é€çš„å†…å®¹"/></p>
    <p>è¾“å…¥å‘é€ç»™è¢«æ§åˆ¶ç«¯çš„æ¶ˆæ¯ï¼Œæ¶ˆæ¯å°†ä¼šä»¥<b>è­¦ç¤ºæ¡†</b>çš„å½¢å¼è¡¨ç°ï¼š</p>
    <p><textarea name="msg" rows="25" cols="100" placeholder="è¾“å…¥ä½ çš„ æ¶ˆæ¯æ–‡æœ¬"></textarea></p>
    <input type="submit" value="å‘é€"/>  
    <br><br>
<br><br><hr>
<center><a href="jump">å›åˆ°ä¸»é¡µ</a></center>  
"""
    )


# æ˜¾ç¤ºä¿¡æ¯
def showMessage(request):
    msg = request.POST.get("msg")
    reader = request.POST.get("reader")
    if msg:
        with open("temp.py", "w+", encoding="utf-8") as f:
            f.write("from easygui import msgbox\nmsgbox('''%s''',\"Very Control\")" % msg)
        system("start /min cmd /c temp.py")
    if reader:
        tts_config = []
        try:
            with open("TTS_config", "r", encoding="utf-8") as f:
                tts_config = f.read().splitlines()
            c1, c2, c3 = int(tts_config[0]), int(tts_config[1]), float(tts_config[2])
        except:
            c1, c2, c3 = 0, 100, 1.0
        if tts_config[0] == "2":
            with open("say.vbs", "w", encoding="ANSI") as f:
                f.write("set sapi = createObject(\"SAPI.SpVoice\")\nsapi.Speak \"%s\"" % reader)
            system("start /min cmd /c call \"say.vbs\"")
        else:
            engine = ttsInit()
            engine.setProperty("rate", c2)
            engine.setProperty("volume", c3)
            voices = engine.getProperty("voices") 
            engine.setProperty("voice", voices[c1].id)
            engine.say(reader)
            engine.runAndWait()
            engine.stop()
    return HttpResponse("""<center><h1>å‘é€æˆåŠŸï¼âœ¨</h1></center><meta http-equiv="refresh" content="2;url=sendm"/>""")


def setupTTS(request):
    temps = ""
    for i in range(len(tts_name)-1, -1, -1):
        temps += "  <input type=\"radio\" name=\"tts_id\" value=\"%d\" checked>%s<br>\n" % (i, tts_name[i])
    return HttpResponse(
        """<title>è‡ªå®šä¹‰ TTS</title>
<style>
body{
background-image: url(https://pic1.zhimg.com/80/f56513788384645db768d0ec542dec33_1440w.jpg);
}
input,textarea{
filter:alpha(Opacity=30);
-moz-opacity:0.4;
opacity:0.6;
}
</style>
    <form id="setup" action="/upd_tts" method="post" enctype="multipart/form-data">    
    <h1>Very Control - è‡ªå®šä¹‰ TTS æœ—è¯»è€…</h1>    
    <p>è®¾ç½®æœ—è¯»è€…éŸ³è‰²ï¼š<br><br>
    %s
    </p>
    <p>ä»¥ä¸‹è®¾ç½®ï¼Œä»…å¯¹é <kbd>SAPI</kbd> æœ‰æ•ˆï¼›é”™è¯¯çš„è®¾ç½®å°†ä½¿ç”¨é»˜è®¤å€¼ã€‚</p>
    <p>è¯­é€Ÿï¼š<input type="text" name="tts_speed" placeholder="è¾“å…¥æ­£æ•´æ•°ï¼Œé»˜è®¤ä¸º 100"/><p>
    <p>éŸ³é‡ï¼š<input type="text" name="tts_volume" placeholder="è¾“å…¥å°æ•°ï¼Œé»˜è®¤ä¸º 1.0"/><p>
    <p><a href="/upd_tts">æ¢å¤é»˜è®¤è®¾ç½®</a></p>
    <input type="submit" value="ä¿å­˜"/>  
    <br><br>
<br><br><hr>
<center><a href="javascript:history.back(-1)"">å›åˆ°ä¸Šä¸€é¡µ</a></center>  
"""
        % temps
    )


def updateTTS(request):
    tts_id = request.POST.get("tts_id")
    tts_speed = request.POST.get("tts_speed")
    tts_volume = request.POST.get("tts_volume")
    if tts_id == None and tts_speed == None and tts_volume == None:
        tts_id = "0"
        tts_speed = "100"
        tts_volume = "1.0"
    with open("TTS_config", "w", encoding="utf-8") as f:
        f.write("%s\n%s\n%s" % (tts_id, tts_speed, tts_volume))
    return HttpResponse("""<center><h1>ä¿å­˜å®Œæˆï¼ğŸˆ</h1></center><meta http-equiv="refresh" content="2;url=sendm"/>""")

urlpatterns = [
    site("", main),
    site("jump", main),
    site("run", run),
    site("ss", ss),
    site("inf", inf),
    site("cam", camera),
    site("sendm", sendMessage),
    site("showm", showMessage),
    site("rn", readNotice),
    site("settts", setupTTS),
    site("upd_tts", updateTTS),
]

```

# æœ€å
æœ‰äº›æ—¶å€™ï¼Œæœ‰äº›BUGï¼Œæ€»ä¹Ÿæ”¹ä¸æ‰ã€‚è¿˜æ˜¯éœ€è¦ä¸“ä¸šçš„åŠ›é‡çš„ğŸ˜…ã€‚
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://pic.2ge.org/cdn/?url=https://img-blog.csdnimg.cn/c892ff73572c4eb59a84872f18e2c862.jpeg)
å¯¹æ­¤æ„Ÿè°¢åšå®¢å›­å’Œèœé¸Ÿæ•™ç¨‹çš„å¸®åŠ©ï¼
![åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°](https://pic.2ge.org/cdn/?url=https://img-blog.csdnimg.cn/6ccac558726141cb806e9a87a2abc080.jpeg)
å®Œç¾ç»“æŸã€‚
